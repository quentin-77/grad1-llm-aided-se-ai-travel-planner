version: '3.9'
services:
  voyageai:
    build:
      context: . 
      args:      
        - NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL}
        - NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY}
        - NEXT_PUBLIC_AMAP_WEB_KEY=${NEXT_PUBLIC_AMAP_WEB_KEY}
    image: voyageai/app:local
    ports:
      - "3000:3000"
    environment:
      # Optional Supabase (enable auth + persistence)
      - NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL}
      - NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY}
      # AI & Speech (optional, app可降级运行)
      - DASH_SCOPE_API_KEY=${DASH_SCOPE_API_KEY}
      - DASH_SCOPE_MODEL=${DASH_SCOPE_MODEL}
      - DASH_SCOPE_TIMEOUT_MS=${DASH_SCOPE_TIMEOUT_MS}
      - ALIBABA_SPEECH_APP_ID=${ALIBABA_SPEECH_APP_ID}
      - ALIBABA_SPEECH_ACCESS_TOKEN=${ALIBABA_SPEECH_ACCESS_TOKEN}
      - ALIBABA_SPEECH_ACCESS_KEY_ID=${ALIBABA_SPEECH_ACCESS_KEY_ID}
      - ALIBABA_SPEECH_ACCESS_KEY_SECRET=${ALIBABA_SPEECH_ACCESS_KEY_SECRET}
      - ALIBABA_SPEECH_REGION=${ALIBABA_SPEECH_REGION}
      - NEXT_PUBLIC_AMAP_WEB_KEY=${NEXT_PUBLIC_AMAP_WEB_KEY}
    env_file:
      - .env